<%- include('partials/header') %>

    <!-- PREMIUM MOBILE CONTAINER -->
    <div class="w-full max-w-md mx-auto px-6 pt-6 pb-24">

        <!-- 1. HEADER & USER INFO -->
        <header class="flex items-center justify-between mb-8">
            <div>
                <p class="text-sm text-gray-500 font-medium mb-1">Welcome back,</p>
                <h1 class="text-3xl font-bold text-gray-900 tracking-tight">
                    <%= user.name %>! <span class="text-2xl">ðŸ‘‹</span>
                </h1>
            </div>
            <% if (subscription && subscription.plan) { %>
                <div class="flex flex-col items-center bg-emerald-50 border border-emerald-100 px-3 py-2 rounded-2xl">
                    <span class="text-[10px] uppercase font-bold text-emerald-600 tracking-wider">PRO PLAN</span>
                    <span class="text-xs font-bold text-gray-700">
                        <%= subscription.daysLeft !==null ? subscription.daysLeft + ' days' : 'Active' %>
                    </span>
                </div>
                <% } %>
        </header>

        <!-- 2. IMPACT TRACKER CARD (Mobile-First, High Contrast) -->
        <section class="mb-8 relative overflow-hidden rounded-3xl shadow-lg"
            style="background-color: #ecfdf5; border: 2px solid #a7f3d0;">

            <!-- Decorative Icon -->
            <div class="absolute top-0 right-0 p-6" style="opacity: 0.15;">
                <i class="fas fa-leaf text-7xl transform rotate-12" style="color: #059669;"></i>
            </div>

            <!-- Card Content -->
            <div class="relative p-6 z-10">
                <!-- Label -->
                <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-seedling text-sm" style="color: #059669;"></i>
                    <span class="text-xs font-bold uppercase tracking-widest" style="color: #047857;">IMPACT
                        TRACKER</span>
                </div>

                <!-- Main Metric -->
                <div class="flex items-baseline gap-3 mb-3">
                    <span class="text-5xl font-extrabold leading-none" style="color: #065f46;">
                        <%= stats.fresh %>
                    </span>
                    <span class="text-xl font-semibold" style="color: #059669;">items saved</span>
                </div>

                <!-- Description -->
                <p class="text-sm leading-relaxed font-medium" style="color: #374151;">
                    Great work! You're reducing food waste and your carbon footprint.
                </p>
            </div>
        </section>

        <!-- 3. SMART ALERTS -->
        <section class="mb-8 space-y-4">
            <% if (stats.expired> 0) { %>
                <div onclick="window.location.href='/inventory/expired'"
                    class="group relative overflow-hidden bg-white border border-red-100 rounded-3xl p-5 shadow-sm active:scale-[0.98] transition-all cursor-pointer">
                    <div class="absolute top-0 left-0 w-1.5 h-full bg-red-500"></div>
                    <div class="flex items-start gap-4 pl-2">
                        <div
                            class="w-10 h-10 rounded-full bg-red-50 text-red-500 flex items-center justify-center shrink-0">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-gray-900">Expired Items Found</h3>
                            <p class="text-xs text-gray-500 mt-1">You have <span class="front-bold text-red-600">
                                    <%= stats.expired %> items
                                </span> to remove.</p>
                        </div>
                        <div class="ml-auto self-center text-gray-300 group-hover:text-red-500 transition-colors">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>
                <% } %>

                    <% if (stats.expiring> 0) { %>
                        <div onclick="window.location.href='/inventory/expiring'"
                            class="group relative overflow-hidden bg-white border border-amber-100 rounded-3xl p-5 shadow-sm active:scale-[0.98] transition-all cursor-pointer">
                            <div class="absolute top-0 left-0 w-1.5 h-full bg-amber-500"></div>
                            <div class="flex items-start gap-4 pl-2">
                                <div
                                    class="w-10 h-10 rounded-full bg-amber-50 text-amber-500 flex items-center justify-center shrink-0">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-gray-900">Use It or Lose It</h3>
                                    <p class="text-xs text-gray-500 mt-1"><span class="font-bold text-amber-600">
                                            <%= stats.expiring %> items
                                        </span> expiring soon.</p>
                                </div>
                                <div
                                    class="ml-auto self-center text-gray-300 group-hover:text-amber-500 transition-colors">
                                    <i class="fas fa-chevron-right"></i>
                                </div>
                            </div>
                        </div>
                        <% } %>
        </section>

        <!-- 4. QUICK ACTIONS GRID -->
        <h2 class="text-lg font-bold text-gray-900 mb-4 px-1">Quick Actions</h2>
        <div class="grid grid-cols-2 gap-4 mb-8">
            <a href="/inventory/add"
                class="flex flex-col items-center justify-center bg-white p-6 rounded-3xl shadow-[0_2px_10px_rgba(0,0,0,0.03)] border border-gray-100 active:scale-95 transition-all group">
                <div
                    class="w-12 h-12 rounded-2xl bg-brand-50 text-brand-600 flex items-center justify-center text-xl mb-3 group-hover:bg-brand-600 group-hover:text-white transition-colors">
                    <i class="fas fa-plus"></i>
                </div>
                <span class="text-sm font-bold text-gray-800">Add Item</span>
            </a>
            <a href="/inventory/add?mode=scan"
                class="flex flex-col items-center justify-center bg-white p-6 rounded-3xl shadow-[0_2px_10px_rgba(0,0,0,0.03)] border border-gray-100 active:scale-95 transition-all group">
                <div
                    class="w-12 h-12 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center text-xl mb-3 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                    <i class="fas fa-barcode"></i>
                </div>
                <span class="text-sm font-bold text-gray-800">Scan</span>
            </a>
        </div>

        <!-- 5. CATEGORY STATS (Horizontal Scroll) -->
        <h2 class="text-lg font-bold text-gray-900 mb-4 px-1">Inventory</h2>
        <div class="flex gap-4 overflow-x-auto pb-4 snap-x hide-scrollbar">
            <!-- Fresh -->
            <a href="/inventory/fresh"
                class="snap-start shrink-0 w-36 bg-white p-4 rounded-[20px] shadow-sm border border-gray-100 flex flex-col justify-between h-32 active:scale-95 transition-all">
                <div class="w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center">
                    <i class="fas fa-leaf text-xs"></i>
                </div>
                <div>
                    <span class="block text-2xl font-bold text-gray-900">
                        <%= stats.fresh %>
                    </span>
                    <span class="text-xs font-medium text-gray-500">Fresh Items</span>
                </div>
            </a>

            <!-- Total -->
            <a href="/inventory/fresh"
                class="snap-start shrink-0 w-36 bg-white p-4 rounded-[20px] shadow-sm border border-gray-100 flex flex-col justify-between h-32 active:scale-95 transition-all">
                <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center">
                    <i class="fas fa-layer-group text-xs"></i>
                </div>
                <div>
                    <span class="block text-2xl font-bold text-gray-900">
                        <%= stats.total %>
                    </span>
                    <span class="text-xs font-medium text-gray-500">Total Stock</span>
                </div>
            </a>

            <!-- Expiring (if not 0, duplicate logic or just show) -->
            <a href="/inventory/expiring"
                class="snap-start shrink-0 w-36 bg-white p-4 rounded-[20px] shadow-sm border border-gray-100 flex flex-col justify-between h-32 active:scale-95 transition-all">
                <div class="w-8 h-8 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center">
                    <i class="fas fa-clock text-xs"></i>
                </div>
                <div>
                    <span class="block text-2xl font-bold text-gray-900">
                        <%= stats.expiring %>
                    </span>
                    <span class="text-xs font-medium text-gray-500">Expiring</span>
                </div>
            </a>
        </div>

    </div>

    <%- include('partials/footer') %>